
@{
    ViewBag.Title = "UploadPhotoSignfromBeni";
    Layout = "~/Views/Shared/_EmptyLayout.cshtml";

}
<style>
</style>
<script src="~/Scripts/jquery.min.js"></script>
<script>
    var BenSno = @Html.Raw(Json.Encode(ViewBag.BenSno))
    var CreatedBy = @Html.Raw(Json.Encode(ViewBag.CreatedBy))
    var UserType = @Html.Raw(Json.Encode(ViewBag.UserType))




</script>
@using (Html.BeginForm("UploadPhotoSign", "Registration", FormMethod.Post, new { id = "UploadForm", onsubmit = "return FinalSubmit()", enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()
    <fieldset class="custom-border">
        <legend class="custom-border ">Upload Documents</legend>
        <div class="row">
            <table class="table table-bordered" style="width:830px;margin-left:15px;">
                <tr>
                    <td class="">Photo of the Applicant <span style="color: red">*</span></td>
                    <td>
                        <input type="file" multiple="multiple" name="files[0]" class="form-control" id="Photo" />
                    </td>
                    <td class=""><font size="2"> &nbsp; Photo limit is upto 2MB, JPEG/PNG</font></td>
                </tr>
                <tr>
                    <td class="">Signature of the Applicant <span style="color: red">*</span></td>
                    <td>
                        <input type="file" multiple="multiple" name="files[1]" class="form-control" id="Signature" />
                    </td>
                    <td class=""><font size="2"> &nbsp; Signature limit is upto 2MB, JPEG/PNG/PDF</font></td>
                </tr>

            </table>
            <center>
                <a class="btn btn-primary finalsub" onclick="DocumnetsFinalSubmit()">Submit</a>
            </center>

        </div>


        <input type="hidden" id="BenSno" value="0" name="BenSno" />
        <input type="hidden" id="UserType" value="0" name="UserType" />
    </fieldset>

}

<script>
    $( document ).ready(function() {
        $("#BenSno").val("123");
        $("#UserType").val(UserType);
        $("#Photo").focus();

    });

    function DocumnetsFinalSubmit()
    {
        if ($("#Photo").val() == "" || $("#Photo").val() == null || $("#Photo").val() == 0) {
            alert("Please Choose Photo");
            $("#Photo").focus();
            return false;
        }
        if ($("#Signature").val() == "" || $("#Signature").val() == null || $("#Signature").val() == 0) {
            alert("Please Choose Signature");
            $("#Signature").focus();
            return false;
        }
        var form = $('#UploadForm')[0];

        var data = new FormData(form);

        $.ajax({
            url: '/Registration/SubmitPhotoSign',
            type: 'post',
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            data: data,
            success: function(data) {

                if(data.Code == "000")
                {
                    $("#Photo").val("");
                    $("#Signature").val("");
                    alert(data.Message);
                    $(".divpart2").show();
                    //BenSno = data.BenSno;
                    //$("#divConfirmSmcCard").modal('show');
                  //  window.location.href = "/SSYIDCard/SSYIDCardNew.aspx/?Benifid="+BenSno;
                    if(UserType =="Dept")
                    {
                        return false;
                    }
                    if(UserType =='Beni')
                    {
                        window.location.href = "/Home/DashBoard";

                    }


                }
                else
                {
                    alert(data.Message);
                    return false;
                    // $("#lblMessage"+data.Value).text(data.Message);
                }


            }
        });
    }

    $('INPUT[type="file"]').change(function () {
         

        //var fname  =  "";

        //if(this.id == "Photo")
        //{
        //    fname ="photo";
        //}
        //if(this.id == "Signature")
        //{
        //    fname ="signature";
        //}


        //if(this.id == "Photo"  || this.id == "Signature")
        //{
        //    if (this.files[0].size < 2000000) {
        //        var ext = this.value.match(/\.(.+)$/)[1];
        //        switch (ext) {
        //            case 'jpg':
        //            case 'jpeg':
        //            case 'png':
        //            case 'JPG':
        //            case 'JPEG':
        //            case 'PNG':
        //                break;
        //            default:

        //                alert('Please choose ' + fname + ' only jpg,jpeg or png,pdf File');

        //                this.value = '';
        //                this.focus();
        //        }
        //    }
        //    else {
        //        alert('Please choose size of ' + fname + ' file below 2MB');
        //        this.value = '';
        //        this.focus();
        //    }
        //}

    });
    function ConfirmDet()
    {
        var conexistreg = $("input[name='conexistregstatus']:checked").val()

        $("#divConfirmexistng").modal('hide');
        if(conexistreg == "Yes")
        {
            //$('#divConfirmexistng').modal('hide');
            // $(".existreglst").prop('checked', false);
            //  $('#divexistng').modal('show');


            window.location.href = "/Registration/BeniPart2?BeniSno="+BenSno;

            return false;
        }
        else
        {
            Endform()
            ///var url = "/SSYIDCard/SmcCardView.aspx/?Benifid="+BenSno;
            //$('iframe#ifr').attr('src', url);
            //$('#myModal').modal('show');
        }
    }
    function Endform()
    {


        //  alert("close click");
        if(CreatedBy == "1"){

            window.location.href = "/Registration/BeniRegistrationPart1?Status=&Id=&CreatedBy=1";
        }
        else
        {
            window.location.href = "/Agent/BenReg";



        }
    }
</script>
