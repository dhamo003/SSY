
<div id="content">
    <div class="row">
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

            <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-1" data-widget-editbutton="false" data-widget-sortable="false">

                <header>
                    <h2>PF PayIn Slips Deposited List </h2>
                </header>
                <!-- widget div-->
                <div>

                    <div class="jarviswidget-editbox">


                    </div>

                    <div class="widget-body no-padding">
                        <!--<div class="ssv-search">
                            <input [(ngModel)]="searchText" placeholder="Search.." class="advancedSearchTextbox">
                            <button><i class="fa fa-search"></i></button>
                        </div>-->
                        <div class="ssv-search">
                            <input type="text" name="depositfromDateSearch" autocomplete="off" class="advancedSearchTextbox" bsDatepicker [bsConfig]="datePickerConfig"
                                   placeholder="Deposit From Date Search.." [maxDate]="toDayDate"
                                   #depositfromDateSearch="ngModel" value="{{ depositFromDate | date: 'dd/MM/yyyy' }}" [(ngModel)]="depositFromDate" />
                            <input type="text" name="deposittoDateSearch" autocomplete="off" class="advancedSearchTextbox" bsDatepicker [bsConfig]="datePickerConfig"
                                   placeholder="Deposit To Date Search.." [maxDate]="toDayDate" [minDate]="depositFromDate"
                                   #deposittoDateSearch="ngModel" value="{{ depositToDate | date: 'dd/MM/yyyy' }}" [(ngModel)]="depositToDate" />
                            <button (click)="GetResults()"><i class="fa fa-search"></i></button>
                        </div>


                        <p></p>

                        <table class="table table-striped" [mfData]="pFDepositDetails.results" #mf="mfDataTable" [mfRowsOnPage]="10">
                            <thead>
                                <tr>
                                    <th>
                                        <mfDefaultSorter>Action</mfDefaultSorter>
                                    </th>
                                    <th>
                                        <mfDefaultSorter by="agentCode">Agent Code</mfDefaultSorter>
                                    </th>
                                    <th>
                                        <mfDefaultSorter by="agentName">Agent Name</mfDefaultSorter>
                                    </th>
                                    <th>
                                        <mfDefaultSorter by="depositAmount">Deposit Amount</mfDefaultSorter>
                                    </th>
                                    <th>
                                        <mfDefaultSorter by="depositDateString">Deposit Date</mfDefaultSorter>
                                    </th>
                                    <th>
                                        <mfDefaultSorter by="bankDepositDateString">Bank Deposit Date</mfDefaultSorter>
                                    </th>
                                    <th>
                                        <mfDefaultSorter by="transactionType">Transaction Type</mfDefaultSorter>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let deposits of mf.data|grdFilter: {agentCode:searchText, agentName: searchText, depositAmount: searchText, depositDateString: searchText, bankDepositDateString: searchText}; let i=index;">
                                    <td class="">
                                        <a (click)="viewCollections(deposits.pfDepositId,deposits.transactionType)" title="View" class="txt-color-red"><i class="fa fa-eye"></i></a>
                                        <a *ngIf="deposits.transactionType !='Legacy'" (click)="viewPayInSlip(deposits.pfDepositId,deposits.transactionType)" title="PayInSlip" class="txt-color-red"><i class="fa fa-file-pdf-o"></i></a>
                                        <a (click)="viewFormIV(deposits)" *ngIf="deposits.transactionType =='Legacy'"title="View Form IV" class="txt-color-red"><i class="fa fa-file-o"></i></a>
                                    </td>
                                    <td>{{deposits.agentCode}}</td>
                                    <td>{{deposits.agentName}}</td>
                                    <td>{{deposits.depositAmount}}</td>
                                    <td>{{deposits.depositDateString}}</td>
                                    <td>{{deposits.bankDepositDateString}}</td>
                                    <td>{{deposits.transactionType}}</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="9">
                                        <div>
                                            <ngb-pagination [collectionSize]="totalRows" [(pageSize)]="pageSize" [(page)]="page" (pageChange)="changepage($event)" [boundaryLinks]="true" [maxSize]="10" [rotate]="true"></ngb-pagination>
                                        </div>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </article>
    </div>
</div>
<div bsModal #attachModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
     aria-hidden="true" backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" (click)="attachModal.hide()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Attachment Details</h4>
            </div>
            <div class="modal-body" style="max-height:500px">
                <div class="row" style="display:inline-flex;width:100%">
                    <div style="width:100%;padding:5px;overflow:scroll;max-height:470px">
                        <accordion>
                            <accordion-group heading="{{item?.fileName}}" *ngFor="let item of payInSlipCertificate">
                            <div *ngIf="item?.fileName?.split('.')[item?.fileName?.split('.').length-1]!='pdf'">
                                <img [src]="'data:image/'+item?.fileName?.split('.')[item?.fileName?.split('.').length-1]+';base64,'+ item?.fileContent" style="max-width:100%" />
                            </div>
                            <div *ngIf="item?.fileName?.split('.')[item?.fileName?.split('.').length-1]=='pdf'">
                                <object [attr.data]="item?.attachmenturl" style="width:100%;height:400px" type="application/pdf"></object>
                            </div>
                            </accordion-group>
                        </accordion>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="attachModal.hide()">
                    Ok
                </button>
            </div>
        </div>
    </div>
</div>
<div bsModal #collectionsModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
     aria-hidden="true" backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" (click)="collectionsModal.hide()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Collection Details</h4>
            </div>
            <div class="modal-body" style="max-height:500px">
                <div class="row">
                    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-1" data-widget-editbutton="false" data-widget-sortable="false">

                            <header>
                                <h2>PF Collections </h2>
                            </header>
                            <!-- widget div-->
                            <div>

                                <div class="jarviswidget-editbox">


                                </div>

                                <div class="widget-body no-padding" *ngIf="isVisible1">
                                    <div class="ssv-search">
                                        <input [(ngModel)]="searchText" placeholder="Search.." class="advancedSearchTextbox">
                                        <button><i class="fa fa-search"></i></button>
                                    </div>


                                    <p></p>

                                    <table id="datatable_fixed_column" class="table table-striped table-bordered"
                                           [mfData]="pfCollectionDetails" #mf="mfDataTable" [mfRowsOnPage]="10" width="100%">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <mfDefaultSorter by="ssI_Number">SSIN</mfDefaultSorter>
                                                </th>
                                                <th>
                                                    <mfDefaultSorter by="benFullName">Beneficiary Name</mfDefaultSorter>
                                                </th>
                                                <th>
                                                    <mfDefaultSorter by="receiptNo">Receipt No</mfDefaultSorter>

                                                </th>
                                                <th>
                                                    <mfDefaultSorter by="bookNo">Book No</mfDefaultSorter>

                                                </th>
                                                <th>
                                                    <mfDefaultSorter by="collectionDateString">Collection Date</mfDefaultSorter>
                                                </th>

                                                <th>
                                                    <mfDefaultSorter by="paidFromMonth">Paid From</mfDefaultSorter>
                                                </th>
                                                <th>
                                                    <mfDefaultSorter by="paidToMonth">Paid To</mfDefaultSorter>
                                                </th>
                                                <th>
                                                    <mfDefaultSorter by="collectionAmount">Amount</mfDefaultSorter>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let col of mf.data; let i=index;">
                                                <td>{{col.ssI_Number}}</td>
                                                <td>{{col.benFullName}}</td>
                                                <td>{{col.receiptNo}}</td>
                                                <td>{{col.bookNo}}</td>
                                                <td>{{col.collectionDateString}}</td>
                                                <td>{{col.paidFromMonth}}</td>
                                                <td>{{col.paidToMonth}}</td>
                                                <td>{{col.collectionAmount}}</td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <td colspan="8">
                                                    <div>
                                                        <mfBootstrapPaginator></mfBootstrapPaginator>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="collectionsModal.hide()">
                    Ok
                </button>
            </div>
        </div>
    </div>
</div>
<div bsModal #attachModalFormIV="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
     aria-hidden="true" backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" (click)="attachModalFormIV.hide()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Form-IV</h4>
            </div>
            <div class="modal-body" style="max-height:600px">
                <div class="row" style="display:inline-flex;width:100%">
                    <div style="display:inline-flex;width:100%">
                        <div style="width:100%;padding:5px;overflow:scroll;max-height:470px;min-height:inherit">
                            <div>
                                <!--<img [src]="ImageSource" style="max-width:100%" />-->
                                <object [attr.data]="attachmenturl" style="width:100%;height:400px" type="application/pdf"></object>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" (click)="attachModalFormIV.hide()">
                            Ok
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


